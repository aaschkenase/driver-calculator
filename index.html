<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Driver Profit Calculator</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background:#0b0f14; color:#e8eef7; }
    .wrap { max-width: 980px; margin: 0 auto; padding: 18px; }
    .card { background:#121a24; border:1px solid #1e2b3a; border-radius:14px; padding: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    h1 { margin: 0 0 6px; font-size: 20px; }
    .sub { margin: 0 0 14px; color:#a8b4c6; font-size: 13px; line-height:1.35; }
    .grid { display:grid; grid-template-columns: 1fr; gap: 12px; }
    @media (min-width: 880px) { .grid { grid-template-columns: 1.1fr .9fr; } }
    table { width:100%; border-collapse: collapse; }
    th, td { padding: 10px 10px; border-bottom: 1px solid #1e2b3a; vertical-align: middle; }
    th { text-align:left; font-size: 12px; letter-spacing:.08em; text-transform: uppercase; color:#9fb0c6; }
    .row-title { font-weight: 600; }
    .muted { color:#9fb0c6; font-size:12px; }
    .right { text-align:right; }
    input[type="number"]{
      width: 140px; max-width: 45vw;
      padding: 8px 10px; border-radius: 10px;
      border: 1px solid #2a3b4f; background:#0b111a; color:#e8eef7;
      outline: none;
    }
    input[type="number"]:focus { border-color:#4b89ff; box-shadow: 0 0 0 3px rgba(75,137,255,.2); }
    .pill { display:inline-block; padding: 4px 10px; border-radius: 999px; background:#0b111a; border:1px solid #223245; color:#a8b4c6; font-size:12px; }
    .kpi { display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .kpi .box { background:#0b111a; border:1px solid #1e2b3a; border-radius: 14px; padding: 12px; }
    .kpi .label { color:#9fb0c6; font-size: 12px; margin-bottom: 6px; }
    .kpi .value { font-size: 22px; font-weight: 800; }
    .good { color:#3dff9a; }
    .bad { color:#ff5c78; }
    .btns { display:flex; gap:10px; flex-wrap: wrap; margin-top: 10px; }
    button {
      border:1px solid #2a3b4f; background:#0b111a; color:#e8eef7;
      padding: 10px 12px; border-radius: 12px; cursor:pointer;
    }
    button:hover { border-color:#4b89ff; }
    .foot { margin-top: 10px; font-size: 12px; color:#9fb0c6; line-height: 1.35; }
    a { color:#8ab4ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .section-title { display:flex; justify-content: space-between; align-items: baseline; gap: 12px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="section-title">
        <h1>Driver Profit Calculator</h1>
        <span class="pill">Simple • Fast • No login</span>
      </div>
      <p class="sub">
        Enter miles + gross revenue, then your weekly expenses. Matches your Excel logic (80% revenue, fuel = miles/MPG × fuel price, maint. savings by mile).
      </p>

      <div class="grid">
        <!-- LEFT: INPUTS + EXPENSES -->
        <div class="card" style="padding:14px;">
          <table>
            <thead>
              <tr><th colspan="2">Inputs</th></tr>
            </thead>
            <tbody>
              <tr>
                <td class="row-title">Total Miles</td>
                <td class="right"><input id="miles" type="number" step="1" min="0" value="1800"></td>
              </tr>
              <tr>
                <td class="row-title">Gross Revenue</td>
                <td class="right"><input id="gross" type="number" step="0.01" min="0" value="5500"></td>
              </tr>
              <tr>
                <td class="row-title">Revenue % (default 80%)</td>
                <td class="right"><input id="revPct" type="number" step="0.01" min="0" max="1" value="0.8"></td>
              </tr>
              <tr>
                <td class="muted">Revenue at %</td>
                <td class="right" id="revAtPct">$0.00</td>
              </tr>
            </tbody>

            <thead>
              <tr><th colspan="2">Expenses (per week)</th></tr>
            </thead>
            <tbody>
              <tr>
                <td class="row-title">MPG</td>
                <td class="right"><input id="mpg" type="number" step="0.1" min="0" value="6.0"></td>
              </tr>
              <tr>
                <td class="row-title">Fuel Price ($/gal)</td>
                <td class="right"><input id="fuelPrice" type="number" step="0.01" min="0" value="3.68"></td>
              </tr>
              <tr>
                <td class="muted">Fuel Cost (auto)</td>
                <td class="right" id="fuelCost">$0.00</td>
              </tr>

              <tr>
                <td class="row-title">Truck Payment</td>
                <td class="right"><input id="truckPay" type="number" step="0.01" min="0" value="800"></td>
              </tr>
              <tr>
                <td class="row-title">Trailer Payment</td>
                <td class="right"><input id="trailerPay" type="number" step="0.01" min="0" value="400"></td>
              </tr>
              <tr>
                <td class="row-title">Insurance</td>
                <td class="right"><input id="insurance" type="number" step="0.01" min="0" value="350"></td>
              </tr>

              <tr>
                <td class="row-title">Maint. Savings (Truck) — 12¢/mile (auto)</td>
                <td class="right" id="maintTruck">$0.00</td>
              </tr>
              <tr>
                <td class="row-title">Maint. Savings (Trailer) — 5¢/mile (auto)</td>
                <td class="right" id="maintTrailer">$0.00</td>
              </tr>

              <tr>
                <td class="row-title">Weekly Repairs (actual)</td>
                <td class="right"><input id="weeklyRepairs" type="number" step="0.01" min="0" value="0"></td>
              </tr>
              <tr>
                <td class="row-title">Cash Advance / Loans</td>
                <td class="right"><input id="cashAdv" type="number" step="0.01" min="0" value="0"></td>
              </tr>
              <tr>
                <td class="row-title">Tolls</td>
                <td class="right"><input id="tolls" type="number" step="0.01" min="0" value="200"></td>
              </tr>
              <tr>
                <td class="row-title">Personal Expenses</td>
                <td class="right"><input id="personal" type="number" step="0.01" min="0" value="0"></td>
              </tr>
              <tr>
                <td class="row-title">Other Expenses</td>
                <td class="right"><input id="other" type="number" step="0.01" min="0" value="0"></td>
              </tr>

              <tr>
                <td class="row-title">Total Expenses</td>
                <td class="right" id="totalExpenses">$0.00</td>
              </tr>
            </tbody>
          </table>

          <div class="btns">
            <button id="resetBtn" type="button">Reset defaults</button>
            <button id="copyLinkBtn" type="button">Copy shareable link</button>
          </div>

          <div class="foot">
            Fuel price reference (EIA): <a href="https://www.eia.gov/petroleum/gasdiesel/" target="_blank" rel="noopener">eia.gov/petroleum/gasdiesel</a>
          </div>
        </div>

        <!-- RIGHT: RESULTS -->
        <div class="card" style="padding:14px;">
          <div class="kpi">
            <div class="box">
              <div class="label">Profit (Revenue @ % − Expenses)</div>
              <div class="value" id="profit">$0.00</div>
            </div>
            <div class="box">
              <div class="label">Profit per Mile</div>
              <div class="value" id="profitPerMile">$0.00</div>
            </div>
            <div class="box">
              <div class="label">Break-even Revenue Needed (at %)</div>
              <div class="value" id="breakEven">$0.00</div>
            </div>
            <div class="box">
              <div class="label">Break-even $/mile (Gross)</div>
              <div class="value" id="breakEvenRpm">$0.00</div>
            </div>
          </div>

          <div class="foot" style="margin-top:14px;">
            Notes:
            <ul style="margin:8px 0 0 18px; padding:0;">
              <li>“Revenue at %” is what you keep (default <b>80%</b>).</li>
              <li>Maint. savings uses <b>$0.12/mi</b> for truck + <b>$0.05/mi</b> for trailer (matches your sheet).</li>
              <li>If profit is negative, either expenses are too high or the load needs a higher rate.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  const $ = (id) => document.getElementById(id);

  const money = (n) => {
    const v = Number.isFinite(n) ? n : 0;
    return v.toLocaleString(undefined, { style: "currency", currency: "USD" });
  };
  const num = (v) => {
    const n = parseFloat(v);
    return Number.isFinite(n) ? n : 0;
  };

  function calc() {
    const miles = num($("miles").value);
    const gross = num($("gross").value);
    const revPct = num($("revPct").value);

    const mpg = num($("mpg").value);
    const fuelPrice = num($("fuelPrice").value);

    // Excel logic
    const revenueAtPct = gross * revPct;
    const fuelCost = (mpg > 0) ? (miles / mpg) * fuelPrice : 0;

    const maintTruck = miles * 0.12;
    const maintTrailer = miles * 0.05;

    const truckPay = num($("truckPay").value);
    const trailerPay = num($("trailerPay").value);
    const insurance = num($("insurance").value);
    const weeklyRepairs = num($("weeklyRepairs").value);
    const cashAdv = num($("cashAdv").value);
    const tolls = num($("tolls").value);
    const personal = num($("personal").value);
    const other = num($("other").value);

    const totalExpenses =
      fuelCost + truckPay + trailerPay + insurance +
      maintTruck + maintTrailer + weeklyRepairs + cashAdv +
      tolls + personal + other;

    const profit = revenueAtPct - totalExpenses;

    // Extras
    const profitPerMile = miles > 0 ? (profit / miles) : 0;
    const breakEvenRevenueAtPct = totalExpenses; // revenue-at-% needed to hit $0 profit
    const breakEvenGross = revPct > 0 ? (breakEvenRevenueAtPct / revPct) : 0;
    const breakEvenRpm = miles > 0 ? (breakEvenGross / miles) : 0;

    // Render
    $("revAtPct").textContent = money(revenueAtPct);
    $("fuelCost").textContent = money(fuelCost);
    $("maintTruck").textContent = money(maintTruck);
    $("maintTrailer").textContent = money(maintTrailer);
    $("totalExpenses").textContent = money(totalExpenses);

    const profitEl = $("profit");
    profitEl.textContent = money(profit);
    profitEl.classList.toggle("good", profit >= 0);
    profitEl.classList.toggle("bad", profit < 0);

    $("profitPerMile").textContent = money(profitPerMile);
    $("breakEven").textContent = money(breakEvenGross);
    $("breakEvenRpm").textContent = money(breakEvenRpm);
  }

  function resetDefaults() {
    $("miles").value = 1800;
    $("gross").value = 5500;
    $("revPct").value = 0.8;

    $("mpg").value = 6.0;
    $("fuelPrice").value = 3.68;

    $("truckPay").value = 800;
    $("trailerPay").value = 400;
    $("insurance").value = 350;

    $("weeklyRepairs").value = 0;
    $("cashAdv").value = 0;
    $("tolls").value = 200;
    $("personal").value = 0;
    $("other").value = 0;

    calc();
  }

  function copyShareableLink() {
    const params = new URLSearchParams({
      miles: $("miles").value,
      gross: $("gross").value,
      revPct: $("revPct").value,
      mpg: $("mpg").value,
      fuelPrice: $("fuelPrice").value,
      truckPay: $("truckPay").value,
      trailerPay: $("trailerPay").value,
      insurance: $("insurance").value,
      weeklyRepairs: $("weeklyRepairs").value,
      cashAdv: $("cashAdv").value,
      tolls: $("tolls").value,
      personal: $("personal").value,
      other: $("other").value
    });
    const url = `${location.origin}${location.pathname}?${params.toString()}`;
    navigator.clipboard.writeText(url).then(() => {
      alert("Shareable link copied!");
    }).catch(() => {
      prompt("Copy this link:", url);
    });
  }

  function loadFromQueryParams() {
    const params = new URLSearchParams(location.search);
    const map = [
      "miles","gross","revPct","mpg","fuelPrice",
      "truckPay","trailerPay","insurance",
      "weeklyRepairs","cashAdv","tolls","personal","other"
    ];
    let changed = false;
    map.forEach(k => {
      if (params.has(k)) { $(k).value = params.get(k); changed = true; }
    });
    if (changed) calc();
  }

  // Wire up events
  document.querySelectorAll("input").forEach(inp => {
    inp.addEventListener("input", calc);
  });
  $("resetBtn").addEventListener("click", resetDefaults);
  $("copyLinkBtn").addEventListener("click", copyShareableLink);

  loadFromQueryParams();
  calc();
</script>
</body>
</html>
